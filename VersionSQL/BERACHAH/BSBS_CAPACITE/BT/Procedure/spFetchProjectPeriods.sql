/****** Object:  Procedure [BT].[spFetchProjectPeriods]    Committed by VersionSQL https://www.versionsql.com ******/

CREATE PROCEDURE BT.spFetchProjectPeriods(@PROJECTCODE INT) 
AS
DECLARE @STARTPERIOD  INT
DECLARE @ENDPERIOD  INT
SELECT @STARTPERIOD=BeginYearPeriodCode,@ENDPERIOD=ENDYEARPERIODCODE FROM BT.PROJECTS WHERE PROJECTCODE=@PROJECTCODE 

SELECT (LTRIM(RTRIM(STR(YEAR)))+'-'+MONTHFULLNAME) AS PERIODNAME,STARTDATE 
FROM BT.YearPeriodMaster WHERE YEARPERIODID BETWEEN @STARTPERIOD AND @ENDPERIOD ORDER BY YEARPERIODID 

 