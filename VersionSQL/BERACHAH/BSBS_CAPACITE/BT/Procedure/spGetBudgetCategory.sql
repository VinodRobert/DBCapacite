/****** Object:  Procedure [BT].[spGetBudgetCategory]    Committed by VersionSQL https://www.versionsql.com ******/

CREATE PROCEDURE [BT].[spGetBudgetCategory](@PROJECTID INT)
AS
UPDATE BT.MonthlyMaterialBudget SET CumulativeQty =0 WHERE CumulativeQty IS NULL
SELECT * INTO #TEMP0  FROM BT.MonthlyMaterialBudget  WHERE PROJECTCODE=@PROJECTID 
ALTER TABLE #TEMP0 ADD   THISREQUISITIONQTY DECIMAL(18,4) 
ALTER TABLE #TEMP0 ADD   THISREQUISITIONVALUE DECIMAL(18,2) 
ALTER TABLE #TEMP0 ADD   BALANCEQTY DECIMAL(18,4)
ALTER TABLE #TEMP0 ADD   BALANCEVALUE DECIMAL(18,2) 

UPDATE #TEMP0 SET  THISREQUISITIONQTY = 0,THISREQUISITIONVALUE=0,BALANCEQTY=0,BALANCEVALUE=0 

SELECT * FROM #TEMP0 ORDER BY BUDGETCATEGORYNAME 
 