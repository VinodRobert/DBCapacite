/****** Object:  Procedure [BS].[PeriodFix]    Committed by VersionSQL https://www.versionsql.com ******/

CREATE Proc [BS].[PeriodFix]
as

UPDATE TRANSACTIONS SET YEAR = 2014 WHERE PDATE>='01-APR-2013' AND PDATE<='31-MAR-2014'
UPDATE TRANSACTIONS SET YEAR = 2015 WHERE PDATE>='01-APR-2014' AND PDATE<='31-MAR-2015'
UPDATE TRANSACTIONS SET YEAR = 2016 WHERE PDATE>='01-APR-2015' AND PDATE<='31-MAR-2016'
UPDATE TRANSACTIONS SET YEAR = 2017 WHERE PDATE>='01-APR-2016' AND PDATE<='31-MAR-2017'
UPDATE TRANSACTIONS SET YEAR = 2018 WHERE PDATE>='01-APR-2017' AND PDATE<='31-MAR-2018'
UPDATE TRANSACTIONS SET YEAR = 2019 WHERE PDATE>='01-APR-2018' AND PDATE<='31-MAR-2019'
UPDATE TRANSACTIONS SET YEAR = 2020 WHERE PDATE>='01-APR-2019' AND PDATE<='31-MAR-2020'
UPDATE TRANSACTIONS SET YEAR = 2021 WHERE PDATE>='01-APR-2020' AND PDATE<='31-MAR-2021'
UPDATE TRANSACTIONS SET YEAR = 2022 WHERE PDATE>='01-APR-2021' AND PDATE<='31-MAR-2022'
UPDATE TRANSACTIONS SET YEAR = 2023 WHERE PDATE>='01-APR-2022' AND PDATE<='31-MAR-2023'

 
UPDATE TRANSACTIONS SET PERIOD=1 WHERE MONTH(PDATE)=4    
UPDATE TRANSACTIONS SET PERIOD=2 WHERE MONTH(PDATE)=5    
UPDATE TRANSACTIONS SET PERIOD=3 WHERE MONTH(PDATE)=6    
UPDATE TRANSACTIONS SET PERIOD=4 WHERE MONTH(PDATE)=7    
UPDATE TRANSACTIONS SET PERIOD=5 WHERE MONTH(PDATE)=8    
UPDATE TRANSACTIONS SET PERIOD=6 WHERE MONTH(PDATE)=9    
UPDATE TRANSACTIONS SET PERIOD=7 WHERE MONTH(PDATE)=10   
UPDATE TRANSACTIONS SET PERIOD=8 WHERE MONTH(PDATE)=11   
UPDATE TRANSACTIONS SET PERIOD=9 WHERE MONTH(PDATE)=12   
UPDATE TRANSACTIONS SET PERIOD=10 WHERE MONTH(PDATE)=1   
UPDATE TRANSACTIONS SET PERIOD=11 WHERE MONTH(PDATE)=2   
UPDATE TRANSACTIONS SET PERIOD=12 WHERE MONTH(PDATE)=3  



--UPDATE JOURNALHEADER  SET JNLYEAR = 2014 WHERE JNLPOSTDATE >= '01-APR-2013' AND JNLPOSTDATE<='31-MAR-2014'
--UPDATE JOURNALHEADER  SET JNLYEAR = 2015 WHERE JNLPOSTDATE >= '01-APR-2014' AND JNLPOSTDATE<='31-MAR-2015'
--UPDATE JOURNALHEADER  SET JNLYEAR = 2016 WHERE JNLPOSTDATE >= '01-APR-2015' AND JNLPOSTDATE<='31-MAR-2016'
--UPDATE JOURNALHEADER  SET JNLYEAR = 2017 WHERE JNLPOSTDATE >= '01-APR-2016' AND JNLPOSTDATE<='31-MAR-2017'
--UPDATE JOURNALHEADER  SET JNLYEAR = 2018 WHERE JNLPOSTDATE >= '01-APR-2017' AND JNLPOSTDATE<='31-MAR-2018'

UPDATE DELIVERIES SET LYEAR = 2014 WHERE DLVRDATE>='01-APR-2013' AND DLVRDATE<='31-MAR-2014'
UPDATE DELIVERIES SET LYEAR = 2015 WHERE DLVRDATE>='01-APR-2014' AND DLVRDATE<='31-MAR-2015'

UPDATE DELIVERIES SET PERIOD=1 WHERE MONTH(DLVRDATE)=4    
UPDATE DELIVERIES SET PERIOD=2 WHERE MONTH(DLVRDATE)=5    
UPDATE DELIVERIES SET PERIOD=3 WHERE MONTH(DLVRDATE)=6    
UPDATE DELIVERIES SET PERIOD=4 WHERE MONTH(DLVRDATE)=7    
UPDATE DELIVERIES SET PERIOD=5 WHERE MONTH(DLVRDATE)=8    
UPDATE DELIVERIES SET PERIOD=6 WHERE MONTH(DLVRDATE)=9    
UPDATE DELIVERIES SET PERIOD=7 WHERE MONTH(DLVRDATE)=10   
UPDATE DELIVERIES SET PERIOD=8 WHERE MONTH(DLVRDATE)=11   
UPDATE DELIVERIES SET PERIOD=9 WHERE MONTH(DLVRDATE)=12   
UPDATE DELIVERIES SET PERIOD=10 WHERE MONTH(DLVRDATE)=1   
UPDATE DELIVERIES SET PERIOD=11 WHERE MONTH(DLVRDATE)=2   
UPDATE DELIVERIES SET PERIOD=12 WHERE MONTH(DLVRDATE)=3  