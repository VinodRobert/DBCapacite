/****** Object:  Procedure [BS].[TRANSDUMP]    Committed by VersionSQL https://www.versionsql.com ******/

CREATE PROCEDURE BS.TRANSDUMP AS 

SELECT 
 T.ORGID,
 B.BORGNAME,
 T.YEAR,
 T.PERIOD,
 T.PDATE,
 T.BATCHREF,
 T.TRANSREF,
 T.TRANSTYPE,
 T.LEDGERCODE,
 L.LEDGERNAME,
 T.CONTRACT,
 C.CONTRNAME,
 T.ACTIVITY,
 A.ACTNAME,
 T.DESCRIPTION,
 T.CURRENCY,
 T.DEBIT,
 T.CREDIT,
 T.CREDNO,
 T.STORE,
 T.RATE,
 T.QUANTITY,
 T.UNIT,
 T.ORDERNO
FROM 
 TRANSACTIONS T 
 INNER JOIN BORGS B ON T.ORGID= B.BORGID 
 INNER JOIN LEDGERCODES L ON T.LEDGERCODE = L.LEDGERCODE
 INNER JOIN CONTRACTS C ON T.CONTRACT = C.CONTRNUMBER 
 INNER JOIN ACTIVITIES A ON T.Activity = A.ACTNUMBER 
WHERE 
 T.YEAR = 2016 AND T.PERIOD <>0 
ORDER BY 
 ORGID,PERIOD  