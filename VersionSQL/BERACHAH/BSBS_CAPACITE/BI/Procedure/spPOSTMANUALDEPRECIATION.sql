/****** Object:  Procedure [BI].[spPOSTMANUALDEPRECIATION]    Committed by VersionSQL https://www.versionsql.com ******/

CREATE PROCEDURE [BI].[spPOSTMANUALDEPRECIATION](@FINYEAR INT,@PERIOD INT,@ASSETID INT, @AMOUNT DECIMAL(18,2))
AS

DECLARE @ASSETNUMBER VARCHAR(15)
DECLARE @OPPLEDGERCODE VARCHAR(10)
DECLARE @LASTDENUMBER INT 
DECLARE @ASSETPOSTDATE DATETIME 

SELECT @ASSETNUMBER=ASSETNUMBER,@OPPLEDGERCODE= ASSETOPPCODE ,@LASTDENUMBER = ASSETDEPPROG   FROM ASSETS WHERE ASSETID=@ASSETID 
 
SELECT @ASSETPOSTDATE = PEDATE FROM PERIODSETUP WHERE ORGID=2 AND PERIOD=@PERIOD   AND YEAR=@FINYEAR 
INSERT INTO [BI].[ASSETPOSTS] (YEAR,PERIOD,ASSETID,ASSETNUMBER,LEDGERCODE,DEBIT,CURRNETCOUNT,BOOKINGDATE,DEPTYPE)
   VALUES (@FINYEAR,@PERIOD,@ASSETID,@ASSETNUMBER,@OPPLEDGERCODE,@AMOUNT,@LASTDENUMBER,@ASSETPOSTDATE,'MANUAL' )


Select 'Succes !!!!! ' AS RESULT




 