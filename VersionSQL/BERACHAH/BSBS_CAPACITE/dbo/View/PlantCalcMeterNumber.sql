/****** Object:  View [dbo].[PlantCalcMeterNumber]    Committed by VersionSQL https://www.versionsql.com ******/

 CREATE VIEW dbo.PlantCalcMeterNumber  AS  SELECT TOP 100 PERCENT dbo.PlantReadings.PltRID AS ID,      dbo.PlantReadings.PeNumber, dbo.PlantMeterNumber.PltMUnit,      MAX(dbo.PlantMeterNumber.PltMeterNum) AS PltMeterNum,      dbo.PlantReadings.PltRDateOfReading,      MAX(dbo.PlantMeterNumber.PltMReplaceDate) AS PltMReplaceDate,      MAX(dbo.PlantMeterNumber.PltMReplaceReading)      AS PltMReplaceReading  FROM dbo.PlantMeterNumber INNER JOIN     dbo.PlantReadings ON      dbo.PlantMeterNumber.PltMPeNamber = dbo.PlantReadings.PeNumber AND      dbo.PlantMeterNumber.PltMReplaceDate <= CONVERT(DATETIME,      dbo.PlantReadings.PltRDateOfReading, 103) AND      dbo.PlantMeterNumber.PltMUnit = dbo.PlantReadings.PltRUnit AND      dbo.PlantMeterNumber.PltMPeNamber = dbo.PlantReadings.PeNumber  GROUP BY dbo.PlantReadings.PltRID, dbo.PlantReadings.PeNumber,      dbo.PlantMeterNumber.PltMUnit,      dbo.PlantReadings.PltRDateOfReading  ORDER BY dbo.PlantReadings.PeNumber, dbo.PlantMeterNumber.PltMUnit,      MAX(dbo.PlantMeterNumber.PltMeterNum),      dbo.PlantReadings.PltRDateOfReading DESC 