/****** Object:  View [dbo].[BORGSINIC]    Committed by VersionSQL https://www.versionsql.com ******/

  CREATE VIEW BORGSINIC  AS  SELECT DISTINCT TABLEINCLUDE.BORGIDINC, TABLEINCLUDE.BORGID  FROM  (  	/*Select All borgs included or not set up*/  	select BORGS.BORGID BORGIDINC, BI.BORGID  	from BORGS  	CROSS JOIN BORGS BI  	left outer join BORGSIC  	on BORGSIC.BORGID = BI.BORGID  	WHERE ((BORGSIC.LEV = 0 and BORGSIC.INC = 1) OR (BORGSIC.BORGID is null) or (BORGS.BORGID = BI.BORGID))  	/*union with all borgs turned on at borg level*/  	UNION ALL  	select BORGS.BORGID BORGIDINC, BORGSIC.BORGID  	from BORGS  	inner join BORGSIC on BORGSIC.THEID = BORGS.BORGID and BORGSIC.LEV = 1  	WHERE BORGSIC.INC = 1  ) as TABLEINCLUDE  left outer join  (  	/*select all borgs excluded at borg level*/  	select BORGS.BORGID BORGIDINC, BORGSIC.BORGID  	from BORGS  	inner join BORGSIC on BORGSIC.THEID = BORGS.BORGID and BORGSIC.LEV = 1  	WHERE BORGSIC.INC = 0  ) as TABLEEXCLUDE  on TABLEINCLUDE.BORGIDINC = TABLEEXCLUDE.BORGIDINC  AND TABLEINCLUDE.BORGID = TABLEEXCLUDE.BORGID  WHERE TABLEEXCLUDE.BORGIDINC IS NULL  AND TABLEEXCLUDE.BORGID IS NULL 