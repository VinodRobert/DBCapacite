/****** Object:  View [dbo].[UIFAmounts]    Committed by VersionSQL https://www.versionsql.com ******/

CREATE VIEW UIFAmounts AS SELECT TOP 100 PERCENT EMPLOYEES.EMPNAME, EMPLOYEES.BANKACCOUNT, EMPLOYEES.BANKACCTYPE, EMPLOYEES.IDNUM,  EMPLOYEES.STARTDATE, EMPLOYEES.BIRTHDAY, EMPLOYEES.TERMDATE, EMPLOYEES.PAYROLLID, EMPLOYEES.STATUSCODE, EMPLOYEES.SURNAME, SUM(EMPED.THEMONEY * EDSETS.TAXPERC / 100) AS uifable, SUM(EMPED.MONEYTAXABLE) AS taxable, EMPED.EMPNUMBER, PAYROLLS.MAXYEAREARNUIFDEDU, UifDeductable.uifdeduc, EMPLOYEES.PERIODPAYMENT,  PERIODENDDATES.PENDDATE, PERIODENDDATES.YEARNO, BORGS.UIFREGNO, BORGS.TAXREGNO, PAYROLLS.IRP5CONTACTNAME, PAYROLLS.IRP5TEL1, PAYROLLS.IRP5EMAIL, EMPLOYEES.BANKBRANCHCODE,  PERIODENDDATES.PERIODNO, EMPLOYEES.EMPID FROM EDSETS RIGHT OUTER JOIN PERIODENDDATES INNER JOIN EMPED ON PERIODENDDATES.PAYROLLID = EMPED.PRLID AND PERIODENDDATES.PERIODNO = EMPED.PERIODNO AND  PERIODENDDATES.YEARNO = EMPED.YEARNO INNER JOIN UifDeductable INNER JOIN EMPLOYEES INNER JOIN PAYROLLS ON EMPLOYEES.PAYROLLID = PAYROLLS.PAYROLLID INNER JOIN BORGS ON PAYROLLS.BORGID = BORGS.BORGID ON UifDeductable.PAYROLLID = EMPLOYEES.PAYROLLID AND  UifDeductable.EMPNUMBER = EMPLOYEES.EMPNUMBER ON EMPED.PRLID = EMPLOYEES.PAYROLLID AND  EMPED.EMPNUMBER = EMPLOYEES.EMPNUMBER AND EMPED.EDSHID = EMPLOYEES.EDSHID AND PERIODENDDATES.PERIODNO = UifDeductable.PERIODNO ON EDSETS.EDSHID = EMPED.EDSHID AND  EDSETS.PAYROLLID = EMPED.PRLID AND EDSETS.EDSNUMBER = EMPED.EDSNUMBER AND  EDSETS.EDSCODE = EMPED.EDSCODE WHERE (EDSETS.ISUIF = 1) GROUP BY EMPLOYEES.BANKACCOUNT, EMPLOYEES.BANKACCTYPE, EMPLOYEES.IDNUM, EMPLOYEES.STARTDATE, EMPLOYEES.BIRTHDAY, EMPLOYEES.TERMDATE, EMPLOYEES.EMPNAME, EMPED.EMPNUMBER, EMPLOYEES.EMPNUMBER,  EMPLOYEES.PAYROLLID, EMPLOYEES.STATUSCODE, EMPLOYEES.SURNAME, EMPLOYEES.EMPNUMBER, PAYROLLS.MAXYEAREARNUIFDEDU, UifDeductable.uifdeduc, EMPLOYEES.PERIODPAYMENT, PERIODENDDATES.PENDDATE, PERIODENDDATES.YEARNO, BORGS.UIFREGNO, BORGS.TAXREGNO, PAYROLLS.IRP5CONTACTNAME, PAYROLLS.IRP5TEL1,  PAYROLLS.IRP5EMAIL, EMPLOYEES.BANKBRANCHCODE, PERIODENDDATES.PERIODNO, employees.empid ORDER BY EMPED.EMPNUMBER