/****** Object:  View [dbo].[bs_ADVISEDAMOUNTS_COST]    Committed by VersionSQL https://www.versionsql.com ******/

CREATE VIEW dbo.bs_ADVISEDAMOUNTS_COST
AS
SELECT     dbo.EMPLOYEES.EMPID, dbo.EMPLOYEES.EMPNUMBER, dbo.EMPLOYEES.EMPNAME, dbo.EMPLOYEES.KNOWNAS, dbo.EMPLOYEES.PAYPOINT, 
                      dbo.EMPLOYEES.TERMDATE, dbo.EMPLOYEES.SEX, dbo.EMPLOYEES.PERIODPAYMENT, dbo.EMPLOYEES.TYPEPAYMENT, 
                      dbo.EMPLOYEES.RATE1, dbo.EMPLOYEES.RATE2, dbo.EMPLOYEES.RATE3, dbo.EMPLOYEES.COST, dbo.EMPLOYEES.TOBETERMDATE, 
                      dbo.EMPLOYEES.EDSHID, dbo.EMPLOYEES.TRAVELRATE, dbo.EMPLOYEES.ISFOREMAN, dbo.EMPLOYEES.FOREMANNUM, 
                      dbo.EMPLOYEES.DEFNT, dbo.EMPLOYEES.DEFOT1, dbo.EMPLOYEES.DEFOT2, dbo.EMPLOYEES.DEFOT3, dbo.EMPLOYEES.DEFOT4, 
                      dbo.EMPLOYEES.DEFOT5, dbo.EMPLOYEES.DEFCOSTALLOC, dbo.EMPLOYEES.DEFCONTRID, dbo.EMPLOYEES.DEFCONTRNUM, 
                      dbo.EMPLOYEES.DEFACTID, dbo.EMPLOYEES.DEFACTNUM, dbo.EMPLOYEES.DEFLEDGERID, dbo.EMPLOYEES.DEFLEDGERCODE, 
                      dbo.EMPLOYEES.DEFPLANT, dbo.EMPLOYEES.DEFDIVISIONID, dbo.EMPLOYEES.CONTRACTEXPDATE, dbo.EMPLOYEES.DEBTNUMBER, 
                      dbo.EMPLOYEES.PAYROLLID, dbo.ADVAMOUNTS.ADVAMID, dbo.ADVAMOUNTS.CONTRID, dbo.ADVAMOUNTS.CONTRNUMBER, 
                      dbo.ADVAMOUNTS.ACTID, dbo.ADVAMOUNTS.ACTNUMBER, dbo.ADVAMOUNTS.LEDGERID, dbo.ADVAMOUNTS.LEDGERCODE, 
                      dbo.ADVAMOUNTS.PENUMBER, dbo.ADVAMOUNTS.DIVID, dbo.ADVAMOUNTS.AMOUNT, dbo.ADVAMOUNTS.EDSHID AS Expr1, 
                      dbo.ADVAMOUNTS.EDSID, dbo.ADVAMOUNTS.EDSCODE, dbo.ADVAMOUNTS.EDSNUMBER, dbo.ADVAMOUNTS.EMPID AS Expr2, 
                      dbo.ADVAMOUNTS.EMPNUMBER AS Expr3, dbo.ADVAMOUNTS.PERIODNO, dbo.ADVAMOUNTS.RUNNO, dbo.ADVAMOUNTS.YEARNO, 
                      dbo.ADVAMOUNTS.COST AS Expr4, dbo.PROJECTS.ProjName, dbo.CONTRACTS.CONTRNAME, dbo.EDSHEADER.EDSHNAME, dbo.EDSETS.EDSDESCR, 
                      dbo.DIVISIONS.DivName, dbo.LEDGERCODES.LedgerName
FROM         dbo.PROJECTS INNER JOIN
                      dbo.CONTRACTS ON dbo.PROJECTS.PROJID = dbo.CONTRACTS.PROJID RIGHT OUTER JOIN
                      dbo.ACTIVITIES RIGHT OUTER JOIN
                      dbo.EDSHEADER RIGHT OUTER JOIN
                      dbo.ADVAMOUNTS INNER JOIN
                      dbo.EMPLOYEES ON dbo.ADVAMOUNTS.EMPNUMBER = dbo.EMPLOYEES.EMPNUMBER AND 
                      dbo.ADVAMOUNTS.PAYROLLID = dbo.EMPLOYEES.PAYROLLID LEFT OUTER JOIN
                      dbo.EDSETS ON dbo.ADVAMOUNTS.EDSID = dbo.EDSETS.EDSID ON dbo.EDSHEADER.EDSHID = dbo.ADVAMOUNTS.EDSHID LEFT OUTER JOIN
                      dbo.DIVISIONS ON dbo.ADVAMOUNTS.DIVID = dbo.DIVISIONS.DivID LEFT OUTER JOIN
                      dbo.LEDGERCODES ON dbo.ADVAMOUNTS.LEDGERCODE = dbo.LEDGERCODES.LedgerCode ON 
                      dbo.ACTIVITIES.ActNumber = dbo.ADVAMOUNTS.ACTNUMBER ON 
                      dbo.CONTRACTS.CONTRNUMBER = dbo.ADVAMOUNTS.CONTRNUMBER
WHERE     (dbo.ADVAMOUNTS.ALLOCATION <> '')